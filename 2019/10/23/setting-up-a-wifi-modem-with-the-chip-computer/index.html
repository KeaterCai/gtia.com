<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>Setting up a wifi modem with the CHIP computer</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Open Graph tags -->

            <meta property="og:type" content="article"/>
            <meta property="og:title" content="Setting up a wifi modem with the CHIP computer"/>
            <meta property="og:url" content="https://gtia.com/2019/10/23/setting-up-a-wifi-modem-with-the-chip-computer/"/>
            <meta property="og:description" content="I was a backer of the original Kickstarter project for the $9 CHIP computer. Over the past several years I accumulated 8 CHIPs and 3 PocketCHIPs. Suffice to say, I'm sitting pretty with CHIPs. My first project with the CHIP computers was setting up Shairplay on one, and hooking it â€¦"/>

    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://gtia.com/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="https://gtia.com/theme/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://gtia.com/theme/css/pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="https://gtia.com/theme/css/style.css" type="text/css"/>
    <!-- JavaScript plugins (requires jQuery) -->
    <script src="//code.jquery.com/jquery.js"></script>

        <link href="https://gtia.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="GozAtari8 ATOM Feed"/>
        <link href="https://gtia.com/feed/index.rss" type="application/atom+xml" rel="alternate"
              title="GozAtari8 RSS Feed"/>

</head>
<body>
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://gtia.com" class="navbar-brand">GozAtari8</a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                        <li >
                            <a href="https://gtia.com/category/2019/">2019</a>
                        </li>
                        <li >
                            <a href="https://gtia.com/category/asides/">Asides</a>
                        </li>
                        <li class="active">
                            <a href="https://gtia.com/category/hardware/">Hardware</a>
                        </li>
                        <li >
                            <a href="https://gtia.com/category/other/">Other</a>
                        </li>
                        <li >
                            <a href="https://gtia.com/category/software/">Software</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="https://gtia.com/archives.html"><i class="icon-th-list"></i>Archives</a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</nav>
<!-- /.navbar -->
<div class="container">
    <div class="row">
        <div class="col-lg-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://gtia.com/2019/10/23/setting-up-a-wifi-modem-with-the-chip-computer/"
                       rel="bookmark"
                       title="Permalink to Setting up a wifi modem with the CHIP computer">
                        Setting up a wifi modem with the CHIP computer
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="icon-calendar"></i>Wed 23 October 2019
    </span>



<span class="label label-default">Tags</span>
	<a href="https://gtia.com/tag/modem/">modem</a>
        /
	<a href="https://gtia.com/tag/tcpser/">tcpser</a>
        /
	<a href="https://gtia.com/tag/chip/">CHIP</a>
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>I was a backer of the original Kickstarter project for the $9 CHIP computer. Over the past several years I accumulated 8 CHIPs and 3 PocketCHIPs. Suffice to say, I'm sitting pretty with CHIPs. </p>
<p>My first project with the CHIP computers was setting up <a href="https://github.com/juhovh/shairplay">Shairplay</a> on one, and hooking it to a 1970s console stereo. The result is a pretty good sounding wireless speaker that I play music from my iPhone or iTunes on the computer.</p>
<p>My next project was to use a CHIP as a wifi modem for my retro computers. I wanted to use the CHIP instead of the Arduino based wifi modem for a couple of reasons. One, I have several CHIPs. Two, I wanted to be able to not only use the modem to connect to BBSes, but I also wanted to be able to ssh to hosts. Finally, I have a couple of old Macs (such as the SE/30) that do not have network cards. Using a CHIP as a PPP server I would be able to give these Macs (and my STs) an IP connections. With the modifications FozzTexx did to <a href="https://github.com/FozzTexx/tcpser">tcpser</a>, I would have a really cool wifi modem that could connect my retro computers to just about anything.</p>
<p>A lot of this article came from came from the hard work of <a href="http://podsix.org/articles/pimodem/">Raspberry Pi modem</a>. </p>
<h2>Getting the hardware ready</h2>
<p>I re-flashed a CHIP, and started to look at how to add a serial port to the little guy. It has a built in UART, but then I would need some level-shifters to make it RS232 compatible. I took the easy way out and bought a FTDI based USB to RS232 cable. My cable arrived, but when I plugged it in... Nothing.</p>
<h2>My kingdom for a driver</h2>
<p>Apparently, every Linux distribution under the sun has the FTDI serial driver, except for the CHIP computer with the 4.4.11 kernel. If you have the 4.4.13 kernel, you can skip these steps.</p>
<p>The internet led me to a defunct page on NTC's BBS in which someone had <a href="https://web.archive.org/web/20180919025028/https://bbs.nextthing.co/t/usb-serial-connection-from-chip-to-cnc-device-large-usb-port/11210/19">compiled the driver for the CHIP</a>. Unfortunately, the link to the driver in Drobox was dead. But, all was not lost. I emailed the person who posted the driver, <a href="https://github.com/danjperron">Daniel Perron</a>, and as luck would have it, he still had a copy and sent it to me. It is now <a href="https://cdn.gtia.com/2019/usbserial.tgz">posted on the internet</a> for others! He was a big help, because the only other solution would be for me to set up and compile the driver, and I don't know if I could have done it.</p>
<p>Once I had the driver, I followed the directions archived at <a href="https://web.archive.org/web/20180919025028/https://bbs.nextthing.co/t/usb-serial-connection-from-chip-to-cnc-device-large-usb-port/11210/19">archive.org</a> and I then had a serial port.</p>
<p>On the CHIP (and as root), navigate to where the serial drivers will go and create a folder named serial there. Check the name of the kernel, if it is 4.4.13-ntc-mlc you are good to go and do not have to follow these directions.</p>
<div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">modules</span><span class="o">/</span><span class="mi">4</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">11</span><span class="o">-</span><span class="n">ntc</span><span class="o">/</span><span class="n">kernel</span><span class="o">/</span><span class="n">drivers</span><span class="o">/</span><span class="n">usb</span>
<span class="n">mkdir</span> <span class="nb">serial</span>
<span class="n">cd</span> <span class="nb">serial</span>
</pre></div>


<p>Now, copy the drivers from the download above into that folder.</p>
<p>Insert the modules:</p>
<div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">insmod</span> <span class="n">usbserial</span><span class="p">.</span><span class="n">ko</span>
<span class="n">sudo</span> <span class="n">insmod</span> <span class="n">ftdi_sio</span><span class="p">.</span><span class="n">ko</span>
</pre></div>


<p>Now plugging in your FTDI device will give you a /dev/ttyUSB0.</p>
<h2>Fixing updates</h2>
<p>You'll need to follow the directions in the <a href="http://www.chip-community.org/index.php/Care_and_Feeding#Update_CHIP_Software">CHIP-Community wiki</a> to update your apt sources so you can actually update the software on the chip and install software. In a nutshell, replace <code>ftp.us.debian.org</code> &amp; <code>http.debian.net</code> in <code>/etc/apt/sources.list</code> with <code>archive.debian.org</code>. Also, replace <code>opensource.nextthing.co</code> with either <code>chip.jfpossibilities.com</code> or <code>chip.lotek.fr</code>. Finally, since the apt sources are no longer being updated, we need to tell apt to ignore any expirations. <code>sudo nano /etc/apt/apt.conf</code> and add the line (the fille will probably be blank and you will be creating it):</p>
<div class="highlight"><pre><span></span><span class="nv">Acquire</span>::<span class="nv">Check</span><span class="o">-</span><span class="nv">Valid</span><span class="o">-</span><span class="k">Until</span> <span class="s2">&quot;</span><span class="s">false</span><span class="s2">&quot;</span><span class="c1">;</span>
</pre></div>


<p>Now your apt commands will work!</p>
<h2>Setting up tcpser</h2>
<p>I'm using <a href="https://github.com/FozzTexx/tcpser">FozzTexx's fork of tcpser</a>. What tcpser does is provide modem emulation. After adding a USB to RS232 adapter (usually based on the FTDI chip), you can plug it into any computer with an RS232 port and tcpser will act like an Hayes compatible modem.</p>
<p>First, I had to set up the CHIP so I could get the tcpser source and compile it.</p>
<div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="k">update</span>
<span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">git</span> <span class="n">build</span><span class="o">-</span><span class="n">essential</span>
</pre></div>


<p>Now I clone the git repository:</p>
<div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">FozzTexx</span><span class="o">/</span><span class="n">tcpser</span>
</pre></div>


<p>And finally, compile that bad boy:</p>
<div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">tcpser</span>
<span class="n">make</span>
</pre></div>


<p>A couple minutes later and I had a <em>tcpser</em> executable in the directory. I'll move it somewhere sane later, I just wanted to try it out.</p>
<div class="highlight"><pre><span></span><span class="p">.</span><span class="o">/</span><span class="n">tcpser</span> <span class="o">-</span><span class="n">d</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyUSB0</span> <span class="o">-</span><span class="n">s</span> <span class="mi">19200</span> <span class="s1">&#39;&amp;K0&#39;</span>
</pre></div>


<p>(The <code>&amp;K0</code> disables flow control, you may need it on, but it worked on my Atari 800 without issue.)</p>
<p>I made a cable that consists mostly of dongles since I didn't have a 9-pin female to female adapter. The cable connected the CHIP to my MegaSTe as my first test. It worked right away!</p>
<p>Tcpser works exactly like a Hayes compatible modem would work. To dial, use <code>atd</code> and the IP address of the host. To hang up, use <code>ath</code>. Depending on your terminal program, you may be able add ip addresses and port numbers and dial out like the old days. If your terminal program can handle ip addresses or domain names, you can pass an address book when <a href="https://github.com/FozzTexx/tcpser">starting tcpser at the command line</a>. </p>
<p>I started writing this article in Vim on my Atari MegaSTe. At 9600 baud it is pretty responsive, except for when it comes time to scroll. My Vim setup is configured for writing, using the <a href="https://github.com/junegunn/goyo.vim">Goyo</a>, <a href="https://github.com/plasticboy/vim-markdown">vim-markdown</a>, and <a href="https://github.com/reedes/vim-pencil">Pencil</a> plugins.</p>
<h2>What's next?</h2>
<p>You can dial out, but it would be nice to connect to the CHIP and then ssh out from there. To do that, install telnetd.</p>
<div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">telnetd</span>
</pre></div>


<p>From your favorite retro computer, you can now dial localhost and connect.</p>
<div class="highlight"><pre><span></span><span class="n">atd</span> <span class="n">localhost</span>
</pre></div>


<p>I need to set up tcpser as a service, so it starts when the CHIP starts up. Right now I ssh into my CHIPs and run tcpser under tmux. I'd love to put the <a href="http://podsix.org/articles/pimodem/">CHIP in a modem case and wire up the LEDs</a>, but maybe later.</p>
            </div>
            <!-- /.entry-content -->
            <script src="https://utteranc.es/client.js"
                repo="mrrcollins/gtiacomments"
                issue-term="title"
                theme="github-light"
                crossorigin="anonymous"
                async>
            </script>
        </article>
    </section>

        </div>
        <div class="col-lg-3 well well-sm" id="sidebar">

<aside>
    <section>
        <ul class="list-group list-group-flush">
                <li class="list-group-item"><h4><i class="icon-home icon-large"></i>Social</h4></li>
                    <li class="list-group-item"><a href="/feeds/all.atom.xml"><i
                            class="icon-RSS-sign icon-large"></i>RSS
                    </a></li>



                <li class="list-group-item"><a href="https://gtia.com/tags.html"><h4><i class="icon-tags icon-large"></i>Tags</h4></a></li>
        </ul>
    </section>
</aside>        </div>
    </div>
</div>
<footer>
    <div class="container">
        <hr>
        <p class="pull-right"><i class="icon-arrow-up"></i> <a href="#">Back to top</a></p>


        <p>&copy; 2019 gozar &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a></p>
    </div>
</footer>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://gtia.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://gtia.com/theme/js/respond.min.js"></script>


</body>
</html>